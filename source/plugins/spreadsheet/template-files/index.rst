.. _impexp_plugin_spshg_template_files:

Rules for template files
------------------------

A template file defines the layout and content for the output CSV/XSLX file
generated by the *Spreadsheet Generator* plugin. The easiest way to create
a template file is to use the graphical user interface of the plugin as
described in :numref:`impexp_plugin_spshg_export_chapter`.
If you want to create a template manually instead, you must comply with the
following simple rules.

-  A template file is a plain-text file.

-  Each line of a template file shall either define a column for the output file
   or contain a comment. Blank lines are not allowed.

-  A column shall be specified as ``[Title:]Content``.

   -  The optional ``Title`` defines the column title that shall be used as
      header information for the resulting output file. If provided, the title
      must be separated from the ``Content`` using a single ``:`` colon. Otherwise,
      a default title will be automatically generated.

   -  The mandatory ``Content`` defines the value that shall be stored
      in this column for each record of the output file. The content can be an expression
      referencing a database column or a static value or a combination of both.
      Please refer to :numref:`impexp_plugin_spshg_column_expressions` for how to write
      column expressions.

-  Comment lines must start with ``//`` or ``;`` as comment marker. They are ignored
   during export.

.. note::
   For every city object, its *object identifier* stored in the GMLID column of
   the CITYOBJECT table will **always be exported as first column of each
   record** in the output file. The name of this first column is always "GMLID".
   Thus, there is no need to define your own column for the GMLID value.

The following snippet shows an example template file.

.. code-block:: text
   :linenos:

   // This is a template file for the export of tabular attribute data.
   // Lines starting with // or ; are comments and will be ignored.
   ;
   Street:ADDRESS/[FIRST]STREET
   Houseno:ADDRESS/[FIRST]HOUSE_NUMBER
   City:ADDRESS/[FIRST]CITY
   Address:ADDRESS/[FIRST]STREET, ADDRESS/[FIRST]HOUSE_NUMBER[EOL]ADDRESS/[FIRST]CITY
   ;
   // Investment required for equipping the city object with solar panels
   Investment:CITYOBJECT_GENERICATTRIB/REALVAL[ATTRNAME = 'SOLAR_SUM_INVEST'] EUR

When using this sample template file in an export operation, a resulting
output file might look like the one illustrated in :numref:`pic_plugin_spreadsheet_table`.

.. figure:: /media/impexp_plugin_spshg_example_exported_table_fig.png
   :name: pic_plugin_spreadsheet_table
   :align: center

   Example output of the table export operation using the sample template
   presented above.